<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>打地鼠小游戏</title>
<style>
    body {
        text-align: center;
        background-color: #dff6f0;
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
    }
    h1 {
        margin-top: 2vw;
        font-size: 6vw;
    }
    #game {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        grid-gap: 2vw;
        justify-items: center;
        margin-top: 2vw;
        padding: 0 2vw;
    }
    .hole {
        width: 28vw;
        height: 28vw;
        background-image: url("hole.png");
        background-size: cover;
        border-radius: 2vw;
        position: relative;
        overflow: hidden;
        cursor: pointer;
    }
    .mole {
        width: 20vw;
        height: 20vw;
        background-image: url("shushu.png");
        background-size: cover;
        position: absolute;
        bottom: -20vw;
        left: 4vw;
        transition: bottom 0.2s;
    }
    .up {
        bottom: 3vw;
    }
    #info {
        margin-top: 2vw;
        font-size: 5vw;
    }
    #start {
        padding: 2vw 4vw;
        background-color: #28a745;
        border: none;
        border-radius: 1vw;
        color: white;
        cursor: pointer;
        font-size: 5vw;
    }
    #start:disabled {
        background-color: #aaa;
        cursor: not-allowed;
    }
</style>
</head>
<body>

<h1>🎯 打地鼠小游戏</h1>
<div id="info">
    分数：<span id="score">0</span>　
    剩余时间：<span id="time">60</span> 秒
</div>
<button id="start">开始游戏</button>

<div id="game"></div>

<audio id="hit-sound" src="hit.wav" preload="auto"></audio>

<script>
    const gameContainer = document.getElementById("game");
    const scoreDisplay = document.getElementById("score");
    const timeDisplay = document.getElementById("time");
    const startBtn = document.getElementById("start");
    const hitSound = document.getElementById("hit-sound");

    let holes = [];
    let score = 0;
    let timeLeft = 60;
    let gameInterval;
    let moleTimeout;
    let moleSpeed = 2000;

    // 创建 9 个洞
    for (let i = 0; i < 9; i++) {
        let hole = document.createElement("div");
        hole.classList.add("hole");

        let mole = document.createElement("div");
        mole.classList.add("mole");

        function hitMole() {
            if (mole.classList.contains("up")) {
                score++;
                scoreDisplay.textContent = score;
                mole.classList.remove("up");
                const sound = new Audio("hit.wav");
                sound.play();
            }
        }

        mole.addEventListener("click", hitMole);
        mole.addEventListener("touchstart", hitMole, { passive: true });

        hole.appendChild(mole);
        gameContainer.appendChild(hole);
        holes.push(mole);
    }

    function randomHole() {
        const index = Math.floor(Math.random() * holes.length);
        return holes[index];
    }

    function showMole() {
        const mole = randomHole();
        mole.classList.add("up");

        moleTimeout = setTimeout(() => {
            mole.classList.remove("up");
        }, 800);
    }

    function startGame() {
        score = 0;
        timeLeft = 60;
        moleSpeed = 2000;
        scoreDisplay.textContent = score;
        timeDisplay.textContent = timeLeft;
        startBtn.disabled = true;

        gameInterval = setInterval(() => {
            timeLeft--;
            timeDisplay.textContent = timeLeft;
            if (timeLeft <= 0) {
                endGame();
            }
        }, 1000);

        const moleLoop = () => {
            if (timeLeft > 0) {
                showMole();
                moleSpeed = Math.max(400, moleSpeed - 50);
                setTimeout(moleLoop, moleSpeed);
            }
        };
        moleLoop();
    }

    function endGame() {
        clearInterval(gameInterval);
        clearTimeout(moleTimeout);
        startBtn.disabled = false;
        alert(`游戏结束！你的得分是 ${score} 分`);
    }

    startBtn.addEventListener("click", startGame);
</script>

</body>
</html>
